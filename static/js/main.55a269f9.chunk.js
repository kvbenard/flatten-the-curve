(this["webpackJsonpflatten-the-curve-react"]=this["webpackJsonpflatten-the-curve-react"]||[]).push([[0],{166:function(t,a,e){t.exports=e(192)},171:function(t,a,e){},173:function(t,a){function e(t){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=173},181:function(t,a,e){},182:function(t,a,e){},186:function(t,a,e){},187:function(t,a,e){},188:function(t,a,e){},190:function(t,a){function e(t){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=190},192:function(t,a,e){"use strict";e.r(a);var n=e(14),i=e.n(n),r=e(158),o=e.n(r),p=(e(171),e(69)),c=e(70),s=e(73),l=e(72),m=e(154),u=e.n(m),d=(e(174),function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(t){var n;return Object(p.a)(this,e),(n=a.call(this,t)).updateData=function(){var t=n.groupDatasetByDate(n.props.measure).map((function(t){return{label:t.date,value:t[n.props.measure]}}));if(n.myChart.data.labels=t.map((function(t){return t.label})),n.myChart.data.datasets[0].data=t.map((function(t){return t.value})),n.myChart.data.datasets[0].fill=!1,n.myChart.data.datasets[0].label=n.props.name,n.myChart.data.datasets[0].borderColor=n.props.color,n.props.annotation){var a=n.groupDatasetByDate(n.props.annotation);n.myChart.data.datasets.length>1?(n.myChart.data.datasets[1].data=a.map((function(t){return t[n.props.annotation]})),n.myChart.data.datasets[1].fill=!1,n.myChart.data.datasets[1].label="Capacit\xe9",n.myChart.data.datasets[1].borderColor="#aaaaaa"):n.myChart.data.datasets.push({fill:!1,data:a.map((function(t){return t[n.props.annotation]})),label:"Capacit\xe9",borderColor:"#aaaaaa"})}n.myChart.options.annotation.annotations[0].value=n.props.date,n.myChart.update()},n.groupDatasetByDate=function(t){var a={};return n.props.data.filter((function(t){return!(n.props.departments.length>0)||n.props.departments.includes(t.department)})).forEach((function(e){var n=e.date;Object.keys(a).includes(n)?a[n][t]=parseInt(e[t])+parseInt(a[n][t]):(a[n]={date:n},a[n][t]=parseInt(e[t]))})),Object.values(a)},n.switchData=function(){n.isAlternative?n.updateData(n.props.data):n.updateData(n.props.alternativeData),n.isAlternative=!n.isAlternative},n.chartRef=i.a.createRef(),n.isAlternative=!1,n}return Object(c.a)(e,[{key:"componentDidMount",value:function(){this.myChart=new u.a(this.chartRef.current,{type:"line",data:{labels:[],datasets:[{}]},options:{responsive:!0,annotation:{annotations:[{drawTime:"afterDatasetsDraw",type:"line",mode:"vertical",scaleID:"x-axis-0",value:"2020-04-20",borderColor:"black",borderWidth:1}]}}}),this.updateData(this.props.data)}},{key:"componentDidUpdate",value:function(){this.updateData(this.props.data)}},{key:"render",value:function(){var t;return this.props.alternativeData&&(t=i.a.createElement("button",{onClick:this.switchData},"Switch")),i.a.createElement("div",null,i.a.createElement("canvas",{ref:this.chartRef}),t)}}]),e}(n.Component)),h=e(128),f=e(152),y=e(161),v=function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(t){var n;return Object(p.a)(this,e),(n=a.call(this,t)).constructDataset=function(t,a){return t.filter((function(t){return(t.department<900||"2A"===t.department||"2B"===t.department)&&t.date===a})).map((function(t){return{id:"FR-"+t.department,value:t.reanimations/t.reanimation_capacity,department:t.department}}))},n.state={currentData:n.constructDataset(n.props.data,n.props.date)},n}return Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.chart=h.b("french-map",f.a),this.chart.geodata=y.a,this.chart.projection=new f.c.Miller,this.chart.responsive.enabled=!0;var a=this.chart.series.push(new f.b);a.useGeodata=!0;var e=a.mapPolygons.template;e.tooltipText="{name}",e.states.create("hover").properties.fill=h.a("#011627"),this.chart.series.values[0].data=this.state.currentData,a.heatRules.push({property:"fill",target:a.mapPolygons.template,min:h.a("#eeeeee"),max:h.a(this.props.colors[this.props.measure]),maxValue:2}),e.events.on("hit",(function(a){a.target.isActive=!a.target.isActive;var e=a.target.dataItem.dataContext.department;t.props.onDepartmentClick(e)}))}},{key:"componentDidUpdate",value:function(){var t=this,a=this.constructDataset(this.props.data,this.props.date);this.chart&&this.chart.series.values[0].data.length>0&&this.chart.series.values[0].data.forEach((function(e,n){var i=a.filter((function(t){return t.id===e.id}))[0];t.chart.series.values[0].data[n].value=i?i.value:0})),this.chart.invalidateRawData()}},{key:"render",value:function(){return i.a.createElement("div",{style:{height:"500px",width:"500px"},id:"french-map"})}}]),e}(n.PureComponent),_=(e(181),function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(t){var n;return Object(p.a)(this,e),(n=a.call(this,t)).ref=i.a.createRef(),n}return Object(c.a)(e,[{key:"componentDidMount",value:function(){this.ref.current.value=this.props.max}},{key:"render",value:function(){return i.a.createElement("input",{ref:this.ref,type:"range",id:"date",name:"date",min:"1",max:this.props.max,onChange:this.props.onChange})}}]),e}(n.PureComponent)),E=(e(182),function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(){var t;Object(p.a)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=a.call.apply(a,[this].concat(i))).getValue=function(){return t.props.data.filter((function(a){return t.props.departments.length>0?t.props.departments.includes(a.department)&&t.props.date===a.date:t.props.date===a.date})).reduce((function(a,e){return parseInt(e[t.props.measure])+a}),0)},t}return Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{style:{backgroundColor:this.props.color},className:"indicator"},i.a.createElement("div",{className:"indicatorsContent"},i.a.createElement("h3",{className:"title"},this.props.name),i.a.createElement("div",{className:"value"},this.getValue())))}}]),e}(n.PureComponent)),b=e(85),D=e(127),C=(e(186),function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(){var t;Object(p.a)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=a.call.apply(a,[this].concat(i))).onElementClicked=function(a){t.props.onClick(t.props.element)},t}return Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"filteredElement"},this.props.element,i.a.createElement("button",{onClick:this.onElementClicked},i.a.createElement(b.a,{icon:D.b})))}}]),e}(n.PureComponent)),g=(e(187),function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(){return Object(p.a)(this,e),a.apply(this,arguments)}return Object(c.a)(e,[{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"filteredElements"},this.props.elements.length>0?this.props.elements.map((function(a){return i.a.createElement(C,{key:a,element:a,onClick:t.props.onElementDeleted})})):i.a.createElement("p",null,"Cliquez sur un d\xe9partement pour le s\xe9l\xe9ctionner"))}}]),e}(n.PureComponent)),k=e(162),w=e(107),O=(e(188),[{department:"01",population:"656955",reanimation_capacity:"22"},{department:"02",population:"526050",reanimation_capacity:"34"},{department:"03",population:"331315",reanimation_capacity:"24"},{department:"04",population:"165197",reanimation_capacity:"6"},{department:"05",population:"141756",reanimation_capacity:"8"},{department:"06",population:"1079396",reanimation_capacity:"89"},{department:"07",population:"326875",reanimation_capacity:"8"},{department:"08",population:"265531",reanimation_capacity:"12"},{department:"09",population:"152398",reanimation_capacity:"8"},{department:"10",population:"309907",reanimation_capacity:"12"},{department:"11",population:"372705",reanimation_capacity:"16"},{department:"12",population:"278360",reanimation_capacity:"11"},{department:"13",population:"2034469",reanimation_capacity:"281"},{department:"14",population:"691453",reanimation_capacity:"91"},{department:"15",population:"142811",reanimation_capacity:"8"},{department:"16",population:"348180",reanimation_capacity:"12"},{department:"17",population:"647080",reanimation_capacity:"30"},{department:"18",population:"296404",reanimation_capacity:"12"},{department:"19",population:"240336",reanimation_capacity:"15"},{department:"2A",population:"162421",reanimation_capacity:"57"},{department:"2B",population:"182258",reanimation_capacity:"14"},{department:"21",population:"532886",reanimation_capacity:"8"},{department:"22",population:"596186",reanimation_capacity:"19"},{department:"23",population:"116270",reanimation_capacity:"40"},{department:"24",population:"408393",reanimation_capacity:"24"},{department:"25",population:"539449",reanimation_capacity:"12"},{department:"26",population:"520560",reanimation_capacity:"20"},{department:"27",population:"600687",reanimation_capacity:"66"},{department:"28",population:"429425",reanimation_capacity:"10"},{department:"29",population:"906554",reanimation_capacity:"8"},{department:"30",population:"748468",reanimation_capacity:"49"},{department:"31",population:"1400935",reanimation_capacity:"153"},{department:"32",population:"190040",reanimation_capacity:"8"},{department:"33",population:"1633440",reanimation_capacity:"183"},{department:"34",population:"1176145",reanimation_capacity:"124"},{department:"35",population:"1082073",reanimation_capacity:"60"},{department:"36",population:"217139",reanimation_capacity:"10"},{department:"37",population:"605380",reanimation_capacity:"79"},{department:"38",population:"1264979",reanimation_capacity:"74"},{department:"39",population:"257849",reanimation_capacity:"8"},{department:"40",population:"411979",reanimation_capacity:"14"},{department:"41",population:"327835",reanimation_capacity:"12"},{department:"42",population:"764737",reanimation_capacity:"70"},{department:"43",population:"226901",reanimation_capacity:"8"},{department:"44",population:"1437137",reanimation_capacity:"77"},{department:"45",population:"682890",reanimation_capacity:"47"},{department:"46",population:"173166",reanimation_capacity:"8"},{department:"47",population:"330336",reanimation_capacity:"11"},{department:"48",population:"76286",reanimation_capacity:"3"},{department:"49",population:"815881",reanimation_capacity:"61"},{department:"50",population:"490669",reanimation_capacity:"28"},{department:"51",population:"563823",reanimation_capacity:"54"},{department:"52",population:"169250",reanimation_capacity:"8"},{department:"53",population:"305365",reanimation_capacity:"8"},{department:"54",population:"730398",reanimation_capacity:"83"},{department:"55",population:"181641",reanimation_capacity:"8"},{department:"56",population:"755566",reanimation_capacity:"22"},{department:"57",population:"1035866",reanimation_capacity:"88"},{department:"58",population:"199596",reanimation_capacity:"12"},{department:"59",population:"2588988",reanimation_capacity:"225"},{department:"60",population:"825077",reanimation_capacity:"36"},{department:"61",population:"276903",reanimation_capacity:"16"},{department:"62",population:"1452778",reanimation_capacity:"85"},{department:"63",population:"660240",reanimation_capacity:"77"},{department:"64",population:"683169",reanimation_capacity:"35"},{department:"65",population:"226839",reanimation_capacity:"12"},{department:"66",population:"479000",reanimation_capacity:"32"},{department:"67",population:"1132607",reanimation_capacity:"122"},{department:"68",population:"763204",reanimation_capacity:"70"},{department:"69",population:"1876051",reanimation_capacity:"192"},{department:"70",population:"233194",reanimation_capacity:"12"},{department:"71",population:"547824",reanimation_capacity:"26"},{department:"72",population:"560227",reanimation_capacity:"17"},{department:"73",population:"432548",reanimation_capacity:"18"},{department:"74",population:"828405",reanimation_capacity:"34"},{department:"75",population:"2148271",reanimation_capacity:"389"},{department:"76",population:"1243788",reanimation_capacity:"93"},{department:"77",population:"1423607",reanimation_capacity:"77"},{department:"78",population:"1448625",reanimation_capacity:"84"},{department:"79",population:"372627",reanimation_capacity:"8"},{department:"80",population:"569769",reanimation_capacity:"58"},{department:"81",population:"387898",reanimation_capacity:"24"},{department:"82",population:"262618",reanimation_capacity:"18"},{department:"83",population:"1073836",reanimation_capacity:"60"},{department:"84",population:"560997",reanimation_capacity:"16"},{department:"85",population:"683187",reanimation_capacity:"18"},{department:"86",population:"437398",reanimation_capacity:"53"},{department:"87",population:"370774",reanimation_capacity:"24"},{department:"88",population:"359520",reanimation_capacity:"8"},{department:"89",population:"332096",reanimation_capacity:"18"},{department:"90",population:"140145",reanimation_capacity:"25"},{department:"91",population:"1319401",reanimation_capacity:"97"},{department:"92",population:"1613762",reanimation_capacity:"184"},{department:"93",population:"1670149",reanimation_capacity:"100"},{department:"94",population:"1406041",reanimation_capacity:"156"},{department:"95",population:"1248354",reanimation_capacity:"60"}]),Y=e(151),j=e.n(Y),M=function(t){Object(s.a)(e,t);var a=Object(l.a)(e);function e(){var t;return Object(p.a)(this,e),(t=a.call(this)).constructDataset=function(a){var e=t.csvJSON(a).filter((function(t){return"0"===t.sexe})).map((function(t){var a=O.filter((function(a){return a.department===t.dep}))[0];return{date:t.jour,department:t.dep,hospitalizations:t.hosp,deaths:t.dc,returnHome:t.rad,reanimations:t.rea,population:a?a.population:0,reanimation_capacity:a?a.reanimation_capacity:0}}));return e.forEach((function(t){var a=j()(t.date).subtract(1,"day").format("YYYY-MM-DD"),n=e.filter((function(e){return e.department===t.department&&e.date===a}))[0];t.newDeaths=n?t.deaths-n.deaths:t.deaths,t.newReturnHome=n?t.returnHome-n.returnHome:t.returnHome})),e},t.csvJSON=function(t){for(var a=t.replace(/"/g,"").split("\n"),e=[],n=a[0].replace(/\s/g,"").replace(/"/g,"").split(";"),i=1;i<a.length;i++)if(a[i]){for(var r={},o=a[i].split(";"),p=0;p<n.length;p++)r[n[p]]=o[p];e.push(r)}return e},t.onChangeHandler=function(a){var e=t.state.datesSize-a.target.value,n=j()(t.state.maxDate).subtract(e,"days");t.setState({currentDate:n})},t.onDepartmentClicked=function(a){var e=t.state.departments.slice(),n=e.indexOf(a);-1===n?e.push(a):e.splice(n,1),t.setState({departments:e})},t.colors={hospitalizations:"#3e95cd",deaths:"#8e5ea2",returnHome:"#3cba9f",reanimations:"#c45850"},t.state={dataset:[],departments:[]},t}return Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://www.data.gouv.fr/fr/datasets/r/63352e38-d353-4b54-bfd1-f1b3ee1cabd7").then((function(t){return t.text()})).then((function(a){var e=t.constructDataset(a),n=[];e.forEach((function(t){n.includes(t.date)||n.push(t.date)}));var i=n.length,r=n.sort((function(t,a){return new Date(a)-new Date(t)}))[0];t.setState({dataset:e,currentDate:j()(r),maxDate:r,datesSize:i})}))}},{key:"render",value:function(){return this.state.dataset.length?i.a.createElement(n.Fragment,null,i.a.createElement("header",null,i.a.createElement("ul",null,i.a.createElement("li",{className:"title"},"Flatten the curve"),i.a.createElement("li",{className:"stick_right"},i.a.createElement(k.a,{trigger:i.a.createElement("button",{className:"button"},"Sources"),modal:!0},(function(t){return i.a.createElement("div",{className:"modal"},i.a.createElement("h1",null,"Hospitalisations, R\xe9animations, D\xe9c\xe8s et Retours au domicile"),i.a.createElement("p",null,"Ces chiffres sont communiqu\xe9s quotidiennement \xe0 19h par Sant\xe9 Publique France. Les informations relatives \xe0 ce jeu de donn\xe9es sont disponibles ici :",i.a.createElement("a",{href:"https://www.data.gouv.fr/fr/datasets/donnees-hospitalieres-relatives-a-lepidemie-de-covid-19/"},"Donn\xe9es hospitali\xe8res relatives \xe0 l'\xe9pid\xe9mie de COVID-19")),i.a.createElement("h1",null,"Capacit\xe9 en r\xe9animation"),i.a.createElement("p",null,"Ces donn\xe9es sont extraites de la Statistique annuelle des \xe9tablissements de sant\xe9 (SAE), bases statistiques. Elles sont disponibles ici : ",i.a.createElement("a",{href:"https://drees.solidarites-sante.gouv.fr/etudes-et-statistiques/publications/article/nombre-de-lits-de-reanimation-de-soins-intensifs-et-de-soins-continus-en-france"},"Nombre de lits de r\xe9animation, de soins intensifs et de soins continus en France, fin 2013 et 2018")),i.a.createElement("p",null,"Ces chiffres datent de fin 2018 donc bien avant la crise du COVID-19. La capacit\xe9 en lits de r\xe9animation a \xe9t\xe9 augment\xe9e pour g\xe9rer l'augmentation importante du besoin. Cependant, afficher ce chiffre sur le graphique montre bien la pression qu'on subit les hopitaux durant cette crise sanitaire."),i.a.createElement("p",null,"Si vous remarquez des anomalies ou si vous avez des suggestions d'am\xe9lioration, n'h\xe9sitez pas \xe0 me contacter directement"),i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("a",{href:"mailto:kv.benard@gmail.com"},i.a.createElement(b.a,{icon:D.a}))),i.a.createElement("li",null,i.a.createElement("a",{href:"https://www.linkedin.com/in/k%C3%A9vin-b%C3%A9nard-b760ba66/"},i.a.createElement(b.a,{icon:w.b})," ")),i.a.createElement("li",null,i.a.createElement("a",{href:"https://github.com/kvbenard"},i.a.createElement(b.a,{icon:w.a})," ")),i.a.createElement("li",null,i.a.createElement("a",{href:"https://twitter.com/BnardKv"},i.a.createElement(b.a,{icon:w.c})))),i.a.createElement("div",{className:"buttonContainer"},i.a.createElement("button",{className:"button",onClick:function(){t()}},"Fermer")))}))))),i.a.createElement("section",null,i.a.createElement("div",{className:"dashboard"},i.a.createElement("div",{className:"mapConatainer"},i.a.createElement(v,{data:this.state.dataset,date:this.state.currentDate.format("YYYY-MM-DD"),onDepartmentClick:this.onDepartmentClicked,colors:this.colors,measure:"reanimations"}),i.a.createElement(_,{onChange:this.onChangeHandler,max:this.state.datesSize}),i.a.createElement("strong",null,"D\xe9partements s\xe9l\xe9ctionn\xe9s :"),i.a.createElement(g,{elements:this.state.departments,onElementDeleted:this.onDepartmentClicked}),i.a.createElement("div",{className:"indicatorsContainer"},i.a.createElement(E,{name:"Hospitalisations",color:this.colors.hospitalizations,data:this.state.dataset,measure:"hospitalizations",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments,onClick:this.onIndicatorClicked}),i.a.createElement(E,{name:"R\xe9animations",color:this.colors.reanimations,data:this.state.dataset,measure:"reanimations",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments}),i.a.createElement(E,{name:"Retours \xe0 domicile",color:this.colors.returnHome,data:this.state.dataset,measure:"returnHome",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments}),i.a.createElement(E,{name:"D\xe9c\xe8s",color:this.colors.deaths,data:this.state.dataset,measure:"deaths",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments}))),i.a.createElement("div",{className:"chartsContainer"},i.a.createElement(d,{data:this.state.dataset,name:"Hospitalisations",measure:"hospitalizations",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments,color:this.colors.hospitalizations}),i.a.createElement(d,{data:this.state.dataset,name:"Reanimations",measure:"reanimations",annotation:"reanimation_capacity",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments,color:this.colors.reanimations}),i.a.createElement(d,{data:this.state.dataset,measure:"returnHome",name:"Retours \xe0 domicile",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments,color:this.colors.returnHome}),i.a.createElement(d,{data:this.state.dataset,measure:"deaths",name:"D\xe9c\xe8s",date:this.state.currentDate.format("YYYY-MM-DD"),departments:this.state.departments,color:this.colors.deaths})))),i.a.createElement("footer",null,i.a.createElement("ul",null,i.a.createElement("li",{className:"credit"},"K\xe9vin B\xe9nard"),i.a.createElement("li",null,i.a.createElement("a",{href:"mailto:kv.benard@gmail.com"},i.a.createElement(b.a,{icon:D.a}))),i.a.createElement("li",null,i.a.createElement("a",{href:"https://www.linkedin.com/in/k%C3%A9vin-b%C3%A9nard-b760ba66/"},i.a.createElement(b.a,{icon:w.b})," ")),i.a.createElement("li",null,i.a.createElement("a",{href:"https://github.com/kvbenard"},i.a.createElement(b.a,{icon:w.a})," ")),i.a.createElement("li",null,i.a.createElement("a",{href:"https://twitter.com/BnardKv"},i.a.createElement(b.a,{icon:w.c})))))):i.a.createElement("h1",null,"Loading")}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[166,1,4]]]);
//# sourceMappingURL=main.55a269f9.chunk.js.map
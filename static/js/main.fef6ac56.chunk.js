(this["webpackJsonpflatten-the-curve-react"]=this["webpackJsonpflatten-the-curve-react"]||[]).push([[0],{157:function(a,t,e){a.exports=e(179)},162:function(a,t,e){},164:function(a,t){function e(a){var t=new Error("Cannot find module '"+a+"'");throw t.code="MODULE_NOT_FOUND",t}e.keys=function(){return[]},e.resolve=e,a.exports=e,e.id=164},171:function(a,t,e){},173:function(a,t,e){},174:function(a,t,e){},175:function(a,t,e){},177:function(a,t){function e(a){var t=new Error("Cannot find module '"+a+"'");throw t.code="MODULE_NOT_FOUND",t}e.keys=function(){return[]},e.resolve=e,a.exports=e,e.id=177},179:function(a,t,e){"use strict";e.r(t);var n=e(33),i=e.n(n),r=e(152),o=e.n(r),p=(e(162),e(68)),c=e(69),m=e(72),u=e(71),s=e(149),l=e.n(s),d=(e(165),function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(a){var n;return Object(p.a)(this,e),(n=t.call(this,a)).updateData=function(a){n.myChart.data.labels=a.map((function(a){return a.label})),n.myChart.data.datasets[0].data=a.map((function(a){return a.value})),n.myChart.data.datasets[0].fill=!1,n.myChart.data.datasets[0].label=n.props.name,n.myChart.data.datasets[0].borderColor=n.props.color,n.props.annotation&&(n.myChart.data.datasets.length>1?(n.myChart.data.datasets[1].data=n.props.annotation.map((function(a){return a.value})),n.myChart.data.datasets[1].fill=!1,n.myChart.data.datasets[1].label="Capacit\xe9",n.myChart.data.datasets[1].borderColor="#aaaaaa"):n.myChart.data.datasets.push({fill:!1,data:n.props.annotation.map((function(a){return a.value})),label:"Capacit\xe9",borderColor:"#aaaaaa"})),n.myChart.update()},n.switchData=function(){n.isAlternative?n.updateData(n.props.data):n.updateData(n.props.alternativeData),n.isAlternative=!n.isAlternative},n.chartRef=i.a.createRef(),n.isAlternative=!1,n}return Object(c.a)(e,[{key:"componentDidMount",value:function(){this.myChart=new l.a(this.chartRef.current,{type:"line",data:{labels:[],datasets:[{}]},options:{responsive:!0,annotation:{annotations:[{drawTime:"afterDatasetsDraw",type:"line",mode:"vertical",scaleID:"x-axis-0",value:"2020-04-20",borderColor:"black",borderWidth:1}]}}}),this.updateData(this.props.data)}},{key:"componentDidUpdate",value:function(){this.updateData(this.props.data)}},{key:"render",value:function(){var a;return this.props.alternativeData&&(a=i.a.createElement("button",{onClick:this.switchData},"Switch")),i.a.createElement("div",null,i.a.createElement("canvas",{ref:this.chartRef}),a)}}]),e}(n.Component)),h=(e(171),[{department:"01",population:"656955",reanimation_capacity:"22"},{department:"02",population:"526050",reanimation_capacity:"34"},{department:"03",population:"331315",reanimation_capacity:"24"},{department:"04",population:"165197",reanimation_capacity:"6"},{department:"05",population:"141756",reanimation_capacity:"8"},{department:"06",population:"1079396",reanimation_capacity:"89"},{department:"07",population:"326875",reanimation_capacity:"8"},{department:"08",population:"265531",reanimation_capacity:"12"},{department:"09",population:"152398",reanimation_capacity:"8"},{department:"10",population:"309907",reanimation_capacity:"12"},{department:"11",population:"372705",reanimation_capacity:"16"},{department:"12",population:"278360",reanimation_capacity:"11"},{department:"13",population:"2034469",reanimation_capacity:"281"},{department:"14",population:"691453",reanimation_capacity:"91"},{department:"15",population:"142811",reanimation_capacity:"8"},{department:"16",population:"348180",reanimation_capacity:"12"},{department:"17",population:"647080",reanimation_capacity:"30"},{department:"18",population:"296404",reanimation_capacity:"12"},{department:"19",population:"240336",reanimation_capacity:"15"},{department:"2A",population:"162421",reanimation_capacity:"57"},{department:"2B",population:"182258",reanimation_capacity:"14"},{department:"21",population:"532886",reanimation_capacity:"8"},{department:"22",population:"596186",reanimation_capacity:"19"},{department:"23",population:"116270",reanimation_capacity:"40"},{department:"24",population:"408393",reanimation_capacity:"24"},{department:"25",population:"539449",reanimation_capacity:"12"},{department:"26",population:"520560",reanimation_capacity:"20"},{department:"27",population:"600687",reanimation_capacity:"66"},{department:"28",population:"429425",reanimation_capacity:"10"},{department:"29",population:"906554",reanimation_capacity:"8"},{department:"30",population:"748468",reanimation_capacity:"49"},{department:"31",population:"1400935",reanimation_capacity:"153"},{department:"32",population:"190040",reanimation_capacity:"8"},{department:"33",population:"1633440",reanimation_capacity:"183"},{department:"34",population:"1176145",reanimation_capacity:"124"},{department:"35",population:"1082073",reanimation_capacity:"60"},{department:"36",population:"217139",reanimation_capacity:"10"},{department:"37",population:"605380",reanimation_capacity:"79"},{department:"38",population:"1264979",reanimation_capacity:"74"},{department:"39",population:"257849",reanimation_capacity:"8"},{department:"40",population:"411979",reanimation_capacity:"14"},{department:"41",population:"327835",reanimation_capacity:"12"},{department:"42",population:"764737",reanimation_capacity:"70"},{department:"43",population:"226901",reanimation_capacity:"8"},{department:"44",population:"1437137",reanimation_capacity:"77"},{department:"45",population:"682890",reanimation_capacity:"47"},{department:"46",population:"173166",reanimation_capacity:"8"},{department:"47",population:"330336",reanimation_capacity:"11"},{department:"48",population:"76286",reanimation_capacity:"3"},{department:"49",population:"815881",reanimation_capacity:"61"},{department:"50",population:"490669",reanimation_capacity:"28"},{department:"51",population:"563823",reanimation_capacity:"54"},{department:"52",population:"169250",reanimation_capacity:"8"},{department:"53",population:"305365",reanimation_capacity:"8"},{department:"54",population:"730398",reanimation_capacity:"83"},{department:"55",population:"181641",reanimation_capacity:"8"},{department:"56",population:"755566",reanimation_capacity:"22"},{department:"57",population:"1035866",reanimation_capacity:"88"},{department:"58",population:"199596",reanimation_capacity:"12"},{department:"59",population:"2588988",reanimation_capacity:"225"},{department:"60",population:"825077",reanimation_capacity:"36"},{department:"61",population:"276903",reanimation_capacity:"16"},{department:"62",population:"1452778",reanimation_capacity:"85"},{department:"63",population:"660240",reanimation_capacity:"77"},{department:"64",population:"683169",reanimation_capacity:"35"},{department:"65",population:"226839",reanimation_capacity:"12"},{department:"66",population:"479000",reanimation_capacity:"32"},{department:"67",population:"1132607",reanimation_capacity:"122"},{department:"68",population:"763204",reanimation_capacity:"70"},{department:"69",population:"1876051",reanimation_capacity:"192"},{department:"70",population:"233194",reanimation_capacity:"12"},{department:"71",population:"547824",reanimation_capacity:"26"},{department:"72",population:"560227",reanimation_capacity:"17"},{department:"73",population:"432548",reanimation_capacity:"18"},{department:"74",population:"828405",reanimation_capacity:"34"},{department:"75",population:"2148271",reanimation_capacity:"389"},{department:"76",population:"1243788",reanimation_capacity:"93"},{department:"77",population:"1423607",reanimation_capacity:"77"},{department:"78",population:"1448625",reanimation_capacity:"84"},{department:"79",population:"372627",reanimation_capacity:"8"},{department:"80",population:"569769",reanimation_capacity:"58"},{department:"81",population:"387898",reanimation_capacity:"24"},{department:"82",population:"262618",reanimation_capacity:"18"},{department:"83",population:"1073836",reanimation_capacity:"60"},{department:"84",population:"560997",reanimation_capacity:"16"},{department:"85",population:"683187",reanimation_capacity:"18"},{department:"86",population:"437398",reanimation_capacity:"53"},{department:"87",population:"370774",reanimation_capacity:"24"},{department:"88",population:"359520",reanimation_capacity:"8"},{department:"89",population:"332096",reanimation_capacity:"18"},{department:"90",population:"140145",reanimation_capacity:"25"},{department:"91",population:"1319401",reanimation_capacity:"97"},{department:"92",population:"1613762",reanimation_capacity:"184"},{department:"93",population:"1670149",reanimation_capacity:"100"},{department:"94",population:"1406041",reanimation_capacity:"156"},{department:"95",population:"1248354",reanimation_capacity:"60"}]),y=e(119),f=e(148),v=e(155),_=function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(){return Object(p.a)(this,e),t.apply(this,arguments)}return Object(c.a)(e,[{key:"componentDidMount",value:function(){var a=this;this.chart=y.b("french-map",f.a),this.chart.geodata=v.a,this.chart.projection=new f.c.Miller,this.chart.responsive.enabled=!0;var t=this.chart.series.push(new f.b);t.useGeodata=!0;var e=t.mapPolygons.template;e.tooltipText="{name}";var n=e.states.create("hover");n.properties.fill=y.a("#011627"),(n=e.states.create("active")).properties.fill=y.a("#011627"),this.chart.series.values[0].data=this.props.data.map((function(a){return{id:"FR-"+a.department,value:a.reanimations/a.reanimation_capacity,department:a.department}})),t.heatRules.push({property:"fill",target:t.mapPolygons.template,min:y.a("#eeeeee"),max:y.a("#ff0000"),maxValue:2}),e.events.on("hit",(function(t){t.target.isActive=!t.target.isActive;var e=t.target.dataItem.dataContext.department;a.props.onDepartmentClick(e)}))}},{key:"componentDidUpdate",value:function(){var a=this,t=this.props.data.map((function(a){return{id:"FR-"+a.department,value:a.reanimations/a.reanimation_capacity,department:a.department}}));this.chart&&this.chart.series.values[0].data.length>0&&this.chart.series.values[0].data.forEach((function(e,n){var i=t.filter((function(a){return a.id===e.id}))[0];a.chart.series.values[0].data[n].value=i?i.value:0})),this.chart.invalidateRawData()}},{key:"render",value:function(){return i.a.createElement("div",{style:{height:"500px",width:"500px"},id:"french-map"})}}]),e}(n.Component),D=(e(173),function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(){return Object(p.a)(this,e),t.apply(this,arguments)}return Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("input",{type:"range",id:"vol",name:"vol",min:"1",max:this.props.max,onChange:this.props.onChange})}}]),e}(n.Component)),b=(e(174),function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(){return Object(p.a)(this,e),t.apply(this,arguments)}return Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{style:{backgroundColor:this.props.indicator.color},className:"indicator"},i.a.createElement("h3",null,this.props.indicator.name),i.a.createElement("div",null,this.props.indicator.value," (",this.props.indicator.altValue,")"))}}]),e}(n.Component)),C=(e(175),function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(){var a;Object(p.a)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=t.call.apply(t,[this].concat(i))).computeIndicators=function(){var t=0===a.props.departments.length?a.props.data:a.props.data.filter((function(t){return a.props.departments.includes(t.department)}));return[{name:"Hospitalisations",color:"#3e95cd",value:t.reduce((function(a,t){return parseInt(a)+parseInt(t.hospitalizations)}),0)},{name:"R\xe9animations",color:"#c45850",value:t.reduce((function(a,t){return parseInt(a)+parseInt(t.reanimations)}),0)},{name:"Retours \xe0 domicile",color:"#8e5ea2",value:t.reduce((function(a,t){return parseInt(a)+parseInt(t.returnHome)}),0)},{name:"D\xe9c\xe8s",color:"#3cba9f",value:t.reduce((function(a,t){return parseInt(a)+parseInt(t.deaths)}),0)}]},a}return Object(c.a)(e,[{key:"render",value:function(){var a=this.computeIndicators();return i.a.createElement("div",{className:"indicators_container"},i.a.createElement(b,{indicator:a[0]}),i.a.createElement(b,{indicator:a[1]}),i.a.createElement(b,{indicator:a[2]}),i.a.createElement(b,{indicator:a[3]}))}}]),e}(n.Component)),w=e(118),g=e.n(w),O=function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(a){var n;Object(p.a)(this,e),(n=t.call(this,a)).filterData=function(a){return n.props.data.filter((function(t){return a.isSame(t.date)&&t.department<900}))},n.onChangeHandler=function(a){var t=n.datesSize-a.target.value,e=g()(n.maxDate).subtract(t,"days");n.setState({currentData:n.filterData(e),currentDate:e})};var i=[];return a.data.forEach((function(a){i.includes(a.date)||i.push(a.date)})),n.datesSize=i.length,n.maxDate=i.sort((function(a,t){return new Date(t)-new Date(a)}))[0],n.state={currentDate:g()(n.maxDate),currentData:n.filterData(g()(n.maxDate))},n}return Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(_,{data:this.state.currentData,onDepartmentClick:this.props.onDepartmentClick}),i.a.createElement(D,{onChange:this.onChangeHandler,max:this.datesSize}),i.a.createElement("div",{className:"currentDate"},this.state.currentDate.format("DD/MM/YYYY")),i.a.createElement(C,{data:this.state.currentData,departments:this.props.departments}))}}]),e}(n.Component);var E=function(a){Object(m.a)(e,a);var t=Object(u.a)(e);function e(){var a;return Object(p.a)(this,e),(a=t.call(this)).constructDataset=function(a){var t=function(a){for(var t=a.replace(/"/g,"").split("\n"),e=[],n=t[0].replace(/\s/g,"").replace(/"/g,"").split(";"),i=1;i<t.length;i++)if(t[i]){for(var r={},o=t[i].split(";"),p=0;p<n.length;p++)r[n[p]]=o[p];e.push(r)}return e}(a).filter((function(a){return"0"===a.sexe&&a.dep<900})).map((function(a){var t=h.filter((function(t){return t.department===a.dep}))[0];return{date:a.jour,department:a.dep,hospitalizations:a.hosp,deaths:a.dc,returnHome:a.rad,reanimations:a.rea,population:t?t.population:1,reanimation_capacity:t?t.reanimation_capacity:1}}));return t.forEach((function(a){var e=g()(a.date).subtract(1,"day").format("YYYY-MM-DD"),n=t.filter((function(t){return t.department===a.department&&t.date===e}))[0];a.newDeaths=n?a.deaths-n.deaths:a.deaths,a.newReturnHome=n?a.returnHome-n.returnHome:a.returnHome})),t},a.groupDatasetByDate=function(a){var t={};return a.forEach((function(a){var e=a.date;Object.keys(t).includes(e)?(t[e].reanimations=parseInt(a.reanimations)+parseInt(t[e].reanimations),t[e].returnHome=parseInt(a.returnHome)+parseInt(t[e].returnHome),t[e].deaths=parseInt(a.deaths)+parseInt(t[e].deaths),t[e].hospitalizations=parseInt(a.hospitalizations)+parseInt(t[e].hospitalizations),t[e].population=parseInt(a.population)+parseInt(t[e].population),t[e].reanimation_capacity=parseInt(a.reanimation_capacity)+parseInt(t[e].reanimation_capacity),t[e].newDeaths=parseInt(a.newDeaths)+parseInt(t[e].newDeaths),t[e].newReturnHome=parseInt(a.newReturnHome)+parseInt(t[e].newReturnHome)):t[e]={date:e,reanimations:a.reanimations,returnHome:a.returnHome,deaths:a.deaths,hospitalizations:a.hospitalizations,population:a.population,reanimation_capacity:a.reanimation_capacity,newDeaths:a.newDeaths,newReturnHome:a.newReturnHome}})),Object.values(t)},a.departmentClicked=function(t){var e=a.state.departments.slice(),n=e.indexOf(t);-1===n?e.push(t):e.splice(n,1),a.setState({departments:e,datasetGroupedByDate:0===e.length?a.groupDatasetByDate(a.state.dataset):a.groupDatasetByDate(a.state.dataset.filter((function(a){return e.includes(a.department)})))})},a.state={dataset:[],datasetGroupedByDate:[],departments:[]},a}return Object(c.a)(e,[{key:"componentDidMount",value:function(){var a=this;fetch("https://www.data.gouv.fr/fr/datasets/r/63352e38-d353-4b54-bfd1-f1b3ee1cabd7").then((function(a){return a.text()})).then((function(t){var e=a.constructDataset(t),n=a.groupDatasetByDate(e);a.setState({dataset:e,datasetGroupedByDate:n})}))}},{key:"render",value:function(){return this.state.dataset.length?i.a.createElement("div",{className:"dashboard"},i.a.createElement(O,{data:this.state.dataset,onDepartmentClick:this.departmentClicked,departments:this.state.departments}),i.a.createElement("div",{className:"chartsContainer"},i.a.createElement(d,{data:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.hospitalizations}})),name:"Hospitalisations",color:"#3e95cd"}),i.a.createElement(d,{data:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.reanimations}})),name:"Reanimations",annotation:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.reanimation_capacity}})),color:"#c45850"}),i.a.createElement(d,{data:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.returnHome}})),alternativeData:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.newReturnHome}})),name:"Retours \xe0 domicile",color:"#8e5ea2"}),i.a.createElement(d,{data:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.deaths}})),alternativeData:this.state.datasetGroupedByDate.map((function(a){return{label:a.date,value:a.newDeaths}})),name:"D\xe9c\xe8s",color:"#3cba9f"}))):i.a.createElement("h1",null,"Loading")}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(a){a.unregister()})).catch((function(a){console.error(a.message)}))}},[[157,1,4]]]);
//# sourceMappingURL=main.fef6ac56.chunk.js.map